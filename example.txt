
Component Intermmediate Result:

Detector -> Race Report -> Static Analyzer

WARNING: ThreadSanitizer: data race (pid=617)
  Write of size 4 at 0x7f9782faf024 by thread T3:
    #0 ap_update_child_status_from_indexes /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/scoreboard.c:422:9 (httpd+0x000000592540)
    #1 worker_thread /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/mpm/worker/worker.c:908:9 (httpd+0x0000005468a2)
    #2 dummy_worker /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/srclib/apr/threadproc/unix/thread.c:127:12 (libapr-0.so.0+0x00000005308e)

  Previous write of size 4 at 0x7f9782faf024 by thread T2:
    #0 ap_update_child_status_from_indexes /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/scoreboard.c:422:9 (httpd+0x000000592540)
    #1 worker_thread /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/mpm/worker/worker.c:908:9 (httpd+0x0000005468a2)
    #2 dummy_worker /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/srclib/apr/threadproc/unix/thread.c:127:12 (libapr-0.so.0+0x00000005308e)

  Thread T3 (tid=621, running) created by thread T1 at:
    #0 pthread_create /home/ruigu/Workspace/llvm-3.6.1.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:896 (httpd+0x00000043cad6)
    #1 apr_thread_create /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/srclib/apr/threadproc/unix/thread.c:165:17 (libapr-0.so.0+0x000000052f2e)
    #2 start_threads /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/mpm/worker/worker.c:1065:18 (httpd+0x00000054590a)
    #3 dummy_worker /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/srclib/apr/threadproc/unix/thread.c:127:12 (libapr-0.so.0+0x00000005308e)

  Thread T2 (tid=620, running) created by thread T1 at:
    #0 pthread_create /home/ruigu/Workspace/llvm-3.6.1.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:896 (httpd+0x00000043cad6)
    #1 apr_thread_create /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/srclib/apr/threadproc/unix/thread.c:165:17 (libapr-0.so.0+0x000000052f2e)
    #2 start_threads /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/mpm/worker/worker.c:1065:18 (httpd+0x00000054590a)
    #3 dummy_worker /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/srclib/apr/threadproc/unix/thread.c:127:12 (libapr-0.so.0+0x00000005308e)

SUMMARY: ThreadSanitizer: data race /home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/scoreboard.c:422 ap_update_child_status_from_indexes


Static Analyzer -> Vulnerable Report -> Attack Matcher

/home/ruigu/Workspace/concurrency-exploits/apache-21287/httpd-2.0.48/server/scoreboard.c:422 strcpy //for demo


//peseudo code

core - 

main:

engine = new owlEngine()
util = new owlUitility()

file = fopen("example_config.txt")
config = util.config_parse(file)

engine.setup_config(config)

engine.initialize() // clean and restart all

engine.setup_envronment() // any pre-setup here e.g. create report dir and file

engine.run() // begin test



owlEngine -

setup_config(config):
this.config = config

initalize:

monitor = new Monitor(config) //monitor race report
detector = new DetecorWrapper(config) //..Valgrind
analyzer = new AnalyzerWrapper(config)
...

run:

monitor.ready()
analyzer.ready()

detector.run()

...











